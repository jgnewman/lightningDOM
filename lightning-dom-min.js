!function(){var e="All nodes in an iteration must have a unique `key` attribute.",t={},n={},r={},a={},o={},i={},s={},h={};if("undefined"==typeof window)throw new Error("You can't use lightningDOM in a non-browser environment.");var u=window.document;function d(e,t,n,r){this.type=e,this.prev=t,this.next=n,this.data=r}function l(e,t,n,r,a){this.tag=e,this.text=r,this.attrs=t,this.children=n,this.parentNode=a,this.key=t.key,this.node=null}l.prototype={build:function(e){var t,n=this.children.length;for(var r in t="text"===this.tag?u.createTextNode(this.text):"keylist"===this.tag?e:u.createElement(this.tag),this.attrs)"key"!==r&&("function"==typeof this.attrs[r]?t[r]=this.attrs[r]:t.setAttribute(r,this.attrs[r]));for(var a=0;a<n;a+=1){var o=this.children[a].build(t);o&&t.appendChild(o)}return this.node=t,"keylist"!==this.tag?t:null},compareAttrsTo:function(e){var t=[],n={};for(var r in this.attrs){var s=!1;for(var h in e.attrs)if(h===r){s=!0,n[r]=!0,e.attrs[h]!==this.attrs[r]&&t.push(new d(i,this,e,[h,e.attrs[h]]));break}s||t.push(new d(o,this,e,[r,this.attrs[r]]))}for(var h in e.attrs)n.hasOwnProperty(h)||t.push(new d(a,this,e,[h,e.attrs[h]]));return t},compareChildrenTo:function(e){var r,a,o,i=[],s=this.children,h=e.children,u=s.length,l=h.length;if(u<l){r=h.slice(0,u),remainder=h.slice(u),o=remainder.length;for(var c=0;c<u;c+=1)i=i.concat(s[c].compareTo(r[c]));for(c=0;c<o;c+=1)i.push(new d(t,null,remainder[c],s[0].node.parentNode))}else if(u>l){a=(r=s.slice(0,l)).length,remainder=s.slice(l),o=remainder.length;for(c=0;c<a;c+=1)i=i.concat(r[c].compareTo(h[c]));for(c=0;c<o;c+=1)i.push(new d(n,remainder[c]))}else for(c=0;c<u;c+=1)i=i.concat(s[c].compareTo(h[c]));return i},compareTo:function(t){var a=[];if(this.tag!==t.tag)a.push(new d(r,this,t));else if("text"===this.tag&&"text"===t.tag)this.text===t.text?a.push(new d(s,this,t)):a.push(new d(r,this,t));else if("keylist"===this.tag&&"keylist"===t.tag){var o=function(t,r){for(var a=[],o={},i={},s=[],u=-1,l=!0,c=t.children.length,f=r.children.length,p=0;p<c;p+=1){for(var v=!1,m=0;m<f;m+=1){var g=t.children[p],y=r.children[m];if("string"!=typeof g.key)throw new Error(e);if(y.key===g.key){i[g.key]=[p,m],v=!0,a=a.concat(g.compareTo(y)),m<u&&(l&&(l=!1),reorders[g]),l&&m<u&&(l=!1),u=m;break}}v||(a.push(new d(n,g)),s.push(p))}for(var p=0;p<f;p+=1){var y=r.children[p];if("string"!=typeof y.key)throw new Error(e);i.hasOwnProperty(y.key)||(o[y.key]=!0)}l&&!Object.keys(o).length||a.push(new d(h,t,r,{parentNode:t.parentNode.node,matches:i,additions:o,removalIndexes:s}));return a}(this,t);o.length&&(a=a.concat(o))}else{var i=this.compareAttrsTo(t);i.length&&(a=a.concat(i));var u=this.compareChildrenTo(t);u.length&&(a=a.concat(u)),!i.length&&a.push(new d(s,this,t))}return a}};var c={app:function(){var e={onmount:[],onunmount:[]};function u(t){for(var n=e[t].length,r=0;r<n;r+=1)e[t][r]();e[t]=[]}function d(t,n){var r=n.children.length;"function"==typeof n.attrs[t]&&e[t].push(n.attrs[t]);for(var a=0;a<r;a+=1)d(t,n.children[a])}function l(e){"function"==typeof e.data[1]?e.prev.node[e.data[0]]=e.data[1]:e.prev.node.setAttribute(e.data[0],e.data[1]),c(e)}function c(e){e.next.node=e.prev.node}function f(e){for(var t,n,r,a,o,i,s,h,u=e.next.children,l=u.length-1,c=e.data.parentNode,f=e.data.matches,p=e.data.additions,v=Object.keys(p).length,m=l;m>=0;m-=1){var g=u[m];if(f.hasOwnProperty(g.key)){if(f[g.key],t=g,n=m===l,r=v,o=(a=e).prev.children,i=n&&o[o-1].key===t.key,s=a.data.matches[t.key],h=s[1]-s[0],i||!n&&h>0&&h!==r-function(e,t){for(var n=e.length,r=0,a=0;a<n&&e[a]<t;a+=1)r+=1;return r}(a.data.removalIndexes,s[0])){var y=u[m+1];c.insertBefore(g.node,y?y.node:null)}}else p.hasOwnProperty(g.key)&&(y=u[m+1],c.insertBefore(g.build(),y?y.node:null),d("onmount",g),v-=1)}}function p(e,t){t.innerHTML="",t.appendChild(e.build()),d("onmount",e),u("onmount")}var v=[],m=null,g=!1,y=null,k=null;function w(e,w){!v.length&&v.push(e),v[1]=w,m||(m=setTimeout(function(){m=null,g?function(e,p){for(var v,m,g,y,k,w=e.compareTo(p),b=w.length,x=0;x<b;x+=1)switch((v=w[x]).type){case t:(k=v).data.appendChild(k.next.build()),d("onmount",k.next);break;case n:(y=v).prev.node.parentNode.removeChild(y.prev.node),d("onunmount",y.prev);break;case r:(g=v).prev.node.parentNode.replaceChild(g.next.build(),g.prev.node),d("onmount",g.next),d("onunmount",g.prev);break;case a:l(v);break;case o:"function"==typeof(m=v).data[1]?m.prev.node[m.data[0]]=void 0:m.prev.node.removeAttribute(m.data),c(m);break;case i:l(v);break;case h:f(v);break;case s:c(v)}u("onunmount"),u("onmount")}(v[0],v[1]):(clearTimeout(y),p(v[1],k)),v=[v[1]]},0))}return{render:function(e,t){k=t,y=setTimeout(function(){v.length<2&&(g=!0,p(e,t))},0)},migrate:function(e,t){return w(e,t),t}}},create:function(e,t,n){for(var r=new l(e,t=t||{},n=n||[]),a=n.length,o=0;o<a;o+=1){var i=n[o];i instanceof Array?n[o]=new l("keylist",{},i,null,r):i instanceof l||(n[o]=new l("text",{},[],String(i)))}return r}};"undefined"!=typeof module?module.exports=c:window.lightningDOM=c}();
