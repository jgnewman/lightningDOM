!function(){var v="All nodes in an iteration must have a unique `key` string attribute.",p={},m={},g={},k={},w={},b={},x={},T={};if("undefined"==typeof window)throw new Error("You can't use lightningDOM in a non-browser environment.");var h=window.document;function y(e,t,n,r){this.type=e,this.prev=t,this.next=n,this.data=r}function s(e,t,n,r,o){this.tag=e,this.text=r,this.attrs=t,this.children=n,this.parentNode=o,this.key=t.key,this.node=null}s.prototype={build:function(e,t){var n,r=this.children.length,o=!1;if(t&&"string"!=typeof this.key)throw new Error(v);for(var a in n="text"===this.tag?h.createTextNode(this.text):"keylist"===this.tag?(o=!0,e):h.createElement(this.tag),this.attrs)"key"!==a&&("function"==typeof this.attrs[a]?n[a]=this.attrs[a]:n.setAttribute(a,this.attrs[a]));for(var i=0;i<r;i+=1){var s=this.children[i].build(n,o);s&&n.appendChild(s)}return this.node=n,"keylist"!==this.tag?n:null},compareAttrsTo:function(e){var t=[],n={};for(var r in this.attrs){var o=!1;for(var a in e.attrs)if(a===r){o=!0,n[r]=!0,e.attrs[a]!==this.attrs[r]&&t.push(new y(b,this,e,[a,e.attrs[a]]));break}o||t.push(new y(w,this,e,[r,this.attrs[r]]))}for(var a in e.attrs)n.hasOwnProperty(a)||t.push(new y(k,this,e,[a,e.attrs[a]]));return t},compareChildrenTo:function(e){var t,n,r,o=[],a=this.children,i=e.children,s=a.length,h=i.length;if(s<h){t=i.slice(0,s),remainder=i.slice(s),r=remainder.length;for(var u=0;u<s;u+=1)o=o.concat(a[u].compareTo(t[u]));for(u=0;u<r;u+=1)o.push(new y(p,null,remainder[u],a[0].node.parentNode))}else if(h<s){n=(t=a.slice(0,h)).length,remainder=a.slice(h),r=remainder.length;for(u=0;u<n;u+=1)o=o.concat(t[u].compareTo(i[u]));for(u=0;u<r;u+=1)o.push(new y(m,remainder[u]))}else for(u=0;u<s;u+=1)o=o.concat(a[u].compareTo(i[u]));return o},compareTo:function(e){var t=[];if(this.tag!==e.tag)t.push(new y(g,this,e));else if("text"===this.tag&&"text"===e.tag)this.text===e.text?t.push(new y(x,this,e)):t.push(new y(g,this,e));else if("keylist"===this.tag&&"keylist"===e.tag){var n=function(e,t){for(var n=[],r={},o={},a=[],i=-1,s=!0,h=e.children.length,u=t.children.length,d=0;d<h;d+=1){for(var l=!1,c=0;c<u;c+=1){var f=e.children[d],p=t.children[c];if("string"!=typeof f.key)throw new Error(v);if(p.key===f.key){o[f.key]=[d,c],l=!0,n=n.concat(f.compareTo(p)),c<i&&(s&&(s=!1),reorders[f]),s&&c<i&&(s=!1),i=c;break}}l||(n.push(new y(m,f)),a.push(d))}for(var d=0;d<u;d+=1){var p=t.children[d];if("string"!=typeof p.key)throw new Error(v);o.hasOwnProperty(p.key)||(r[p.key]=!0)}s&&!Object.keys(r).length||n.push(new y(T,e,t,{parentNode:e.parentNode.node,matches:o,additions:r,removalIndexes:a}));return n}(this,e);n.length&&(t=t.concat(n))}else{var r=this.compareAttrsTo(e);r.length&&(t=t.concat(r));var o=this.compareChildrenTo(e);o.length&&(t=t.concat(o)),!r.length&&t.push(new y(x,this,e))}return t}};var e={app:function(){var o={onmount:[],onunmount:[]};function d(e){for(var t=o[e].length,n=0;n<t;n+=1)o[e][n]();o[e]=[]}function y(e,t){var n=t.children.length;"function"==typeof t.attrs[e]&&o[e].push(t.attrs[e]);for(var r=0;r<n;r+=1)y(e,t.children[r])}function l(e){"function"==typeof e.data[1]?e.prev.node[e.data[0]]=e.data[1]:e.prev.node.setAttribute(e.data[0],e.data[1]),c(e)}function c(e){e.next.node=e.prev.node}function f(e){for(var t,n,r,o,a,i,s,h,u=e.next.children,d=u.length-1,l=e.data.parentNode,c=e.data.matches,f=e.data.additions,p=Object.keys(f).length,v=d;0<=v;v-=1){var m=u[v];if(c.hasOwnProperty(m.key)){if(c[m.key],t=m,n=v===d,r=p,a=(o=e).prev.children,i=n&&a[a-1].key===t.key,s=o.data.matches[t.key],h=s[1]-s[0],i||!n&&0<h&&h!==r-function(e,t){for(var n=e.length,r=0,o=0;o<n&&e[o]<t;o+=1)r+=1;return r}(o.data.removalIndexes,s[0])){var g=u[v+1];l.insertBefore(m.node,g?g.node:null)}}else f.hasOwnProperty(m.key)&&(g=u[v+1],l.insertBefore(m.build(),g?g.node:null),y("onmount",m),p-=1)}}function n(e,t){t.innerHTML="",t.appendChild(e.build()),y("onmount",e),d("onmount")}var r=[],a=null,i=!1,s=null,h=null;function u(e,t){!r.length&&r.push(e),r[1]=t,a||(a=setTimeout(function(){a=null,i?function(e,t){for(var n,r,o,a,i,s=e.compareTo(t),h=s.length,u=0;u<h;u+=1)switch((n=s[u]).type){case p:(i=n).data.appendChild(i.next.build()),y("onmount",i.next);break;case m:(a=n).prev.node.parentNode.removeChild(a.prev.node),y("onunmount",a.prev);break;case g:(o=n).prev.node.parentNode.replaceChild(o.next.build(),o.prev.node),y("onmount",o.next),y("onunmount",o.prev);break;case k:l(n);break;case w:"function"==typeof(r=n).data[1]?r.prev.node[r.data[0]]=void 0:r.prev.node.removeAttribute(r.data),c(r);break;case b:l(n);break;case T:f(n);break;case x:c(n)}d("onunmount"),d("onmount")}(r[0],r[1]):(clearTimeout(s),n(r[1],h)),r=[r[1]]},0))}return{render:function(e,t){h=t,s=setTimeout(function(){r.length<2&&(i=!0,n(e,t))},0)},migrate:function(e,t){return u(e,t),t}}},create:function(e,t,n){for(var r=new s(e,t=t||{},n=n||[]),o=n.length,a=0;a<o;a+=1){var i=n[a];i instanceof Array?n[a]=new s("keylist",{},i,null,r):i instanceof s||(n[a]=new s("text",{},[],String(i)))}return r}};"undefined"!=typeof module?module.exports=e:window.lightningDOM=e}();
